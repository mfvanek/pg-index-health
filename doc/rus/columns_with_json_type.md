# Проверка наличия столбцов с типом json в таблицах

## Как хранить json в таблице

Для хранения данных в json-формате в PostgreSQL есть два типа json и jsonb.
Первый тип хранит точную копию записанного теста, второй - json-данные в двоичном формате.

## Почему лучше jsonb-тип

В документации [прямо говорится](https://postgrespro.ru/docs/postgresql/17/datatype-json), что jsonb предпочтительнее.
jsonb поддерживает ограничения и индексы, что дает возможность выполнять поиск по таким данным быстрее.
Только вставка данных в тип jsonb будет медленнее, чем в json из-за того, что их нужно преобразовать в двоичный формат.
Для данных в формате jsonb и json можно использовать оператор DISTINCT, но полученные результаты сравнения могут отличаться. DISTINCT  учитывает как структуру, так и содержимое json-объектов. Два json-объекта считаются уникальными, если их ключи и значения различаются.
В jsonb ключи хранятся в отсортированном порядке, поэтому порядок ключей не влияет на результат сравнения. Для типа json объекты с разным порядком одинаковых пар ключ-значение будут считаться разными.

## SQL запрос

- [columns_with_json_type.sql](https://github.com/mfvanek/pg-index-health-sql/blob/master/sql/columns_with_json_type.sql)

## Тип проверки

- **static** (может выполняться на пустой БД в компонентных\интеграционных тестах)

## Поддержка секционированных таблиц

Поддерживает секционированные таблицы.
Проверка выполняется на самой секционированной таблице (родительской). Отдельные секции (потомки) игнорируются.
