# Проверка наличия таблиц c данными, которые не соответствуют ограничениям этих таблиц

## Почему данные могут не соответствовать работающим ограничениям
Ограничение-проверка или внешний ключ могут создаваться с указанием NOT VALID. Это означает, что новые записи будут вноситься в таблицу в соответствии с этим ограничением, но старые записи не будут проверены. Это удобно для больших таблиц: проверка того, что все существующие строки удовлетворяют ограничению, требует длительной блокировки.
Выполнить проверку всех данных [можно позже в более удобное время](https://postgrespro.ru/docs/postgrespro/17/sql-altertable#SQL-ALTERTABLE-NOTES) командой VALIDATE CONSTRAINT. Но если не задокументировали то, что надо провалидировать ограничение, или просто забыли это сделать, данные в таблице так и остаются не полностью корректными.

## Как работает эта проверка
При вызове метода класса этой проверки doCheck выполняется sql-запрос [sql](https://github.com/mfvanek/pg-index-health-sql/blob/master/sql/not_valid_constraints.sql).
Работает для статического анализа в runtime-варианте на работающем инстансе базы данных.
Не подходит для секционированных таблиц.
