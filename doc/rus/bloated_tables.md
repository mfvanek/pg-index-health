# Проверка раздувания таблиц

## Почему раздуваются таблицы

Частые UPDATE и DELETE операции могут вызвать заметное увеличение размера таблицы,
потому что старые версии строк [не удаляются сразу](https://postgrespro.ru/docs/postgresql/17/routine-vacuuming).
Неблокирующая очистка помечает эти устаревшие версии как удаленные и они могу потом использоваться для добавления новых строк,
но физическое место возвращается системе только, если эти удаленные строки были в конце таблице.

## Почему нужно следить за раздуванием таблиц

Хотя устаревшие записи постепенно обработаются демоном автоочистки, размер таблицы останется слишком большим, а таблица разреженной.
Это приведет к снижению производительности, потому что сканирование таблицы будет происходить медленнее.
Поэтому важно отслеживать резкое изменение размера таблиц, если данные часто обновляются.
Данные о слишком быстром росте размера таблицы могут также говорить о том, что автоочистка настроена неправильно и нужно менять эти настройки.

## SQL запрос

- [bloated_tables.sql](https://github.com/mfvanek/pg-index-health-sql/blob/master/sql/bloated_tables.sql)

## Тип проверки

- **runtime** (требует наличия накопленной статистики)

## Поддержка секционированных таблиц

Поддерживает секционированные таблицы. Процент раздувания считается для каждой секции отдельно.

## Как работает эта проверка

TODO Необходимые права доступа и принцип работы
