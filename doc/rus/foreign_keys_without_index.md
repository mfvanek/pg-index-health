# Проверка присутствия внешних ключей без индексов

## Особенности создания внешних ключей 
Когда [создаем ограничение внешнего ключа](https://postgrespro.ru/docs/postgresql/17/ddl-constraints#DDL-CONSTRAINTS-FK), по умолчанию нет требования создавать индекс на столбец с внешним ключом.

## Почему надо создавать внешние ключи с индексами
Если у стоблца с внешним ключом нет индекса, то при поиске строк с одинаковым внешним ключом идет последовательное сканирование всей таблицы, что снижает производительность.
Также при удалении данных из главной таблицы идет проверка на ссылочную целостность, что тоже вызывает поcледовательное сканирование связанной таблицы с внешнем ключом без индекса на нем.
При этом нужно оценить, насколько часто идет поиск или изменение данных по этому столбцу. Если нечасто и/или таблица, содержащая столбец с внешним ключом, небольшого размера, то добавление индекса может не улучшить производительность.

## Как работает эта проверка
При вызове метода класса этой проверки doCheck выполняется sql-запрос [sql](https://github.com/mfvanek/pg-index-health-sql/blob/master/sql/foreign_keys_without_index.sql).
Работает для статического анализа.
Не подходит для секционированных таблиц.
